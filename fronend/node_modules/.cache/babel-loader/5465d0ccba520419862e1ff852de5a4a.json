{"remainingRequest":"C:\\xampp\\htdocs\\Project\\fronend\\node_modules\\babel-loader\\lib\\index.js!C:\\xampp\\htdocs\\Project\\fronend\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\xampp\\htdocs\\Project\\fronend\\src\\pages\\callback.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\xampp\\htdocs\\Project\\fronend\\src\\pages\\callback.vue","mtime":1545615565252},{"path":"C:\\xampp\\htdocs\\Project\\fronend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1545615479486},{"path":"C:\\xampp\\htdocs\\Project\\fronend\\node_modules\\babel-loader\\lib\\index.js","mtime":1545615475266},{"path":"C:\\xampp\\htdocs\\Project\\fronend\\node_modules\\vue-loader\\lib\\index.js","mtime":1545615557804}],"contextDependencies":[],"result":["import \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"C:\\\\xampp\\\\htdocs\\\\Project\\\\fronend\\\\node_modules\\\\@babel\\\\runtime/helpers/builtin/es6/asyncToGenerator\";\n//\n//\n//\n//\n//\n//\nimport UserStore from '@/stores/UserStore';\nimport router from '@/router';\nexport default {\n  name: 'callback',\n  components: {},\n  data: function data() {\n    return {};\n  },\n  methods: {\n    getTokenLine: function () {\n      var _getTokenLine = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee() {\n        var optionts;\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                if (!((this.$route.query.code == undefined || this.$route.query.code == \"\") && (this.$route.query.state == undefined || this.$route.query.state == \"\"))) {\n                  _context.next = 2;\n                  break;\n                }\n\n                return _context.abrupt(\"return\", false);\n\n              case 2:\n                optionts = {\n                  code: this.$route.query.code,\n                  state: this.$route.query.state\n                };\n                _context.next = 5;\n                return UserStore.dispatch('getTokenLine', optionts);\n\n              case 5:\n                console.log(UserStore.state.access_token);\n\n                if (!(UserStore.state.access_token.status == 200)) {\n                  _context.next = 12;\n                  break;\n                }\n\n                localStorage.access_token = UserStore.state.access_token.access_token;\n                _context.next = 10;\n                return this.getUser();\n\n              case 10:\n                _context.next = 13;\n                break;\n\n              case 12:\n                router.push('/');\n\n              case 13:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      return function getTokenLine() {\n        return _getTokenLine.apply(this, arguments);\n      };\n    }(),\n    getUser: function () {\n      var _getUser = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee2() {\n        var optionts;\n        return regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                if (!localStorage.access_token) router.push(\"/\");\n                optionts = {\n                  access_token: localStorage.access_token\n                };\n                _context2.next = 4;\n                return UserStore.dispatch(\"getUser\", optionts);\n\n              case 4:\n                if (UserStore.state.user.status == 200) {\n                  router.push(\"/\");\n                } else if (UserStore.state.user.status == 400) {\n                  router.push(\"/logout\");\n                }\n\n              case 5:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      return function getUser() {\n        return _getUser.apply(this, arguments);\n      };\n    }()\n  },\n  mounted: function () {\n    var _mounted = _asyncToGenerator(\n    /*#__PURE__*/\n    regeneratorRuntime.mark(function _callee3() {\n      return regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              _context3.next = 2;\n              return this.getTokenLine();\n\n            case 2:\n              if (localStorage.access_token) router.push('/');else router.push('/');\n\n            case 3:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3, this);\n    }));\n\n    return function mounted() {\n      return _mounted.apply(this, arguments);\n    };\n  }()\n};",{"version":3,"sources":["callback.vue"],"names":[],"mappings":";;;;;;;;AAOA,OAAA,SAAA,MAAA,oBAAA;AACA,OAAA,MAAA,MAAA,UAAA;AACA,eAAA;AACA,QAAA,UADA;AAEA,cAAA,EAFA;AAIA,MAJA,kBAIA;AACA,WAAA,EAAA;AAGA,GARA;AASA,WAAA;AACA;AAAA;AAAA;AAAA,8BAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBAEA,CAAA,KAAA,MAAA,CAAA,KAAA,CAAA,IAAA,IAAA,SAAA,IAAA,KAAA,MAAA,CAAA,KAAA,CAAA,IAAA,IAAA,EAAA,MAEA,KAAA,MAAA,CAAA,KAAA,CAAA,KAAA,IAAA,SAAA,IAAA,KAAA,MAAA,CAAA,KAAA,CAAA,KAAA,IAAA,EAFA,CAFA;AAAA;AAAA;AAAA;;AAAA,iDAMA,KANA;;AAAA;AAQA,wBARA,GAQA;AACA,wBAAA,KAAA,MAAA,CAAA,KAAA,CAAA,IADA;AAEA,yBAAA,KAAA,MAAA,CAAA,KAAA,CAAA;AAFA,iBARA;AAAA;AAAA,uBAYA,UAAA,QAAA,CAAA,cAAA,EAAA,QAAA,CAZA;;AAAA;AAaA,wBAAA,GAAA,CAAA,UAAA,KAAA,CAAA,YAAA;;AAbA,sBAcA,UAAA,KAAA,CAAA,YAAA,CAAA,MAAA,IAAA,GAdA;AAAA;AAAA;AAAA;;AAeA,6BAAA,YAAA,GAAA,UAAA,KAAA,CAAA,YAAA,CAAA,YAAA;AAfA;AAAA,uBAgBA,KAAA,OAAA,EAhBA;;AAAA;AAAA;AAAA;;AAAA;AAkBA,uBAAA,IAAA,CAAA,GAAA;;AAlBA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAA;;AAAA;AAAA;AAAA;AAAA,OADA;AAsBA;AAAA;AAAA;AAAA,8BAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA,oBAAA,CAAA,aAAA,YAAA,EAAA,OAAA,IAAA,CAAA,GAAA;AACA,wBAFA,GAEA;AACA,gCAAA,aAAA;AADA,iBAFA;AAAA;AAAA,uBAKA,UAAA,QAAA,CAAA,SAAA,EAAA,QAAA,CALA;;AAAA;AAOA,oBAAA,UAAA,KAAA,CAAA,IAAA,CAAA,MAAA,IAAA,GAAA,EAAA;AACA,yBAAA,IAAA,CAAA,GAAA;AACA,iBAFA,MAEA,IAAA,UAAA,KAAA,CAAA,IAAA,CAAA,MAAA,IAAA,GAAA,EAAA;AACA,yBAAA,IAAA,CAAA,SAAA;AACA;;AAXA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAA;;AAAA;AAAA;AAAA;AAAA;AAtBA,GATA;AA6CA,SA7CA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBA8CA,KAAA,YAAA,EA9CA;;AAAA;AA+CA,kBAAA,aAAA,YAAA,EAAA,OAAA,IAAA,CAAA,GAAA,EAAA,KACA,OAAA,IAAA,CAAA,GAAA;;AAhDA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA,CAAA","sourcesContent":["\r\n<template>\r\n    <div>กรุณารอสักครู่...</div>\r\n</template>\r\n\r\n\r\n<script>\r\nimport UserStore from '@/stores/UserStore'\r\nimport router from '@/router'\r\nexport default {\r\n  name: 'callback',\r\n  components: {\r\n  },\r\n  data(){\r\n      return {\r\n        \r\n      }\r\n  },\r\n  methods: {\r\n    getTokenLine: async function() {\r\n      if(\r\n        (this.$route.query.code == undefined || this.$route.query.code == \"\")\r\n        &&\r\n        (this.$route.query.state == undefined || this.$route.query.state == \"\")\r\n      ){\r\n        return false;\r\n      }\r\n      let optionts = {\r\n        code : this.$route.query.code,\r\n        state : this.$route.query.state\r\n      }\r\n      await UserStore.dispatch('getTokenLine',optionts)\r\n      console.log(UserStore.state.access_token);\r\n      if(UserStore.state.access_token.status == 200){\r\n          localStorage.access_token = UserStore.state.access_token.access_token;\r\n          await this.getUser()\r\n      }else{\r\n        router.push('/')\r\n      }\r\n    },\r\n    getUser: async function() {\r\n      if (!localStorage.access_token) router.push(\"/\");\r\n      let optionts = {\r\n        access_token: localStorage.access_token\r\n      };\r\n      await UserStore.dispatch(\"getUser\", optionts);\r\n\r\n      if (UserStore.state.user.status == 200) {\r\n        router.push(\"/\");\r\n      } else if (UserStore.state.user.status == 400) {\r\n        router.push(\"/logout\");\r\n      }\r\n    },\r\n  },\r\n  async mounted () {\r\n    await this.getTokenLine()\r\n    if(localStorage.access_token) router.push('/')\r\n    else router.push('/')\r\n  },\r\n}\r\n</script>\r\n"],"sourceRoot":"src\\pages"}]}